# 同步异步

## 单线程

* js是单线程的语言，很有必要
* 单线程意味着:如果在同个时间有多个任务时，这些任务就需要进行排队，前一个任务执行完，才会执行下一个任务。

## 同步任务异步任务

### 同步任务

* 是指在主线程上进行的任务，只有前一个任务执行完毕的话，才能继续执行下一个任务。

### 异步任务

* 是指不进入主线程，而进入任务队列的任务，只有任务队列通知主线程，某个异步任务可以执行了，该任务才会进入主线程，(图片的加载，音乐的加载)
* 异步的任务会先进入任务队列(也是一个事件队列)，比如文件读取操作，等到IO任务完成之后，就会在任务队列加入一个事件，表示异步任务已经完成。可以进入执行栈了。主线程现在不一定会有空，当主线程内没有了任务的时候，就会依次执行任务队列中的事件。如果任务指定了回调函数，那么就会执行回调函数中的代码。

#### 异步的任务都有哪些

1. http请求线程
2. 浏览器的定时触发器
3. 浏览器的事件触发线程

* 当遇到这些事情的时候，浏览器会为这些耗时的任务开辟另外的线程，说明js的宿主环境是多线程的(代码的执行和资源的加载在宿主环境的多个现线程中同时进行)。
* 异步是目的，多线程是完成这个目的的一种方法
* 异步的定义：异步是调用一个调用请求给被调用者，而调用者不用等待其结果的返回。
* 异步的本质和计算机基础有关，有些任务只需要cpu发送一个指令，接着有关硬件就去和内存进行数据的交换，此时cpu是空闲的。因此cpu此时不必要等待，可以去执行其他需要cpu的任务，等到硬件完成了响应的任务在回过头来执行异步任务。

##### 定时器

* 定时器的异步原理和数据的请求不太一样(不涉及到cpu和其他硬件设备的关系)
* 有一篇文章说定时器会开启Web Worker 并且会有很多限制，比如无法读取DOM对象，不知道是否为真(在谷歌的文章收藏里面)

#### 异步的机制

1. 所有的同步任务都在主线程上被执行，形成一个执行栈，
2. 主线程之外还会有一个任务队列，只要异步任务有了结果，就会在任务队列中放置一个事件。
3. 一旦主执行栈上的所有同步任务执行完毕，就会读取任务对垒，看看有哪些事件，执行对应的异步任务，然后结束等待状态，进入执行栈。
4. 主线程不断的执行第三步

#### 异步编程

* 回调函数：回调函数就是一个通过函数指针调用的函数。如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，我们就说这是回调函数。回调函数不是由该函数的实现方直接调用，而是在特定的事件或条件发生时由另外的一方调用的，用于对该事件或条件进行响应。

* Promise方式 以后再进行总结 也有一些疑问，比如获取数据后通常都要对数据进行处理，获取数据的方法被异步了，那就没有数据能被执行。js如何处理这个异步执行代码的范围。